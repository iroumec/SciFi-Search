{{ define "title" }}SciFi Search{{ end }}

{{ define "content" }}

    <!DOCTYPE html>
    <html lang="es">
    
    <head>
        <meta charset="UTF-8">
        <title>Buscador MeiliSearch</title>
        <link rel="stylesheet" href="style.css">
    </head>
    
    <body>
        <main>
            <h1>Buscador</h1>
            <input type="text" id="query" placeholder="Buscar...">
            <button id="searchBtn">Buscar</button>
            <ul id="results"></ul>
        </main>
    
        <script src="app.js"></script>
    </body>
    
    </html>


    {{ $facultades := .Facultades }}
    <section class="navegacion-facultades">
        <nav>
            {{ range $facultades }}
            <button class="btn-{{ . }}" onclick="window.location.href='/facultades?facultad={{ . }}'">
                {{ . | title }}
            </button>
            {{ end }}
        </nav>
    </section>

    <section class="fondo">
        <div class="fondo-contenido">
            <!-- <p>puntos parciales</p> TODO -->
        </div>
    </section>

    <section class="partidos">
        <div class="partidos-contenedor">
            <h2>Proximo partido: </h3>
            <!-- Filtros -->
            <div class="filtros">
                <div class="filtro">
                    <span>Facultad:</span>
                    <button data-facultad="Exactas">Exactas</button>
                    <button data-facultad="Económicas">Económicas</button>
                    <button data-facultad="Arte">Arte</button>
                    <button data-facultad="Veterinarias">Veterinarias</button>
                </div>
                <div class="filtro">
                    <span>Deporte:</span>
                    <button data-deporte="Hockey">Hockey</button>
                    <button data-deporte="Fútbol">Fútbol</button>
                    <button data-deporte="Voley">Voley</button>
                </div>
            </div>
        </div>
    </section>

    <section class="noticias">
        <h2>Noticias</h2>
        <button onclick="window.location.href='/noticias'">Noticias</button>
    </section>

    <section id="ultimos-partidos">
        <h2>Ultimos partidos</h2>
        <p>Aca van los posteos de los ultimos partidos. Se publica las facultades, el resultado y fotos del post original. Aca se va a poder comentar comentarios y fotos.</p>
    </section>

    <script>
        document.getElementById("searchBtn").addEventListener("click", async () => {
        const query = document.getElementById("query").value.trim();
        if (!query) return;
        
        const res = await fetch(`/search?q=${encodeURIComponent(query)}`);
        if (!res.ok) {
        alert("Error al realizar la búsqueda");
        return;
        }
        
        const data = await res.json();
        mostrarResultados(data.hits);
        });
        
        function mostrarResultados(hits) {
            const list = document.getElementById("results");
            list.innerHTML = "";
            
            if (!hits || hits.length === 0) {
                list.innerHTML = "<li>Sin resultados</li>";
                return;
            }
            
            hits.forEach(hit => {
                const li = document.createElement("li");
                li.textContent = JSON.stringify(hit);
                list.appendChild(li);
            });
        }

    </script>
{{ end }}